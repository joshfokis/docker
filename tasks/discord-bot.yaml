- name: Update discord-bot code
  git:
    repo: https://gitlab.theflinners.com/joshfokis/discord-bot.git
    update: yes
    dest: /media/c/configs/scripts/discord-bot/

- name: Restart a container
  docker_container:
    name: discordbot
    image: python:3
    state: started
    pull: true
    restart: yes
    restart_policy: unless-stopped
    env:
        APITOKEN: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39376564613866386238313562313936366265396165333537343163643366346262313164323865
          3633333665666464386335366231376233303236326531370a393833383561316531326465613830
          66343765336232653730383834323832643264613238633035383965623339303434366131386361
          6532313963333435360a336261393161643037336433316664363965613535356230303730313931
          37363036313938393532633636376663336466636366383061323063663230373761
        DISCORDTOKEN: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34373938363336303932633162626239623130363962373165653730313632643835663866643735
          3437653965656564353330623666613164323239373364360a623633316462363135323465313663
          64313835393735306461636233633335383166323932636665383837336563383261666163653639
          3832376635353933660a323635346536643863646133316531656230393863363231323339663838
          65353561313039653830353237313239393531376331623839613133393037373331326331323333
          66366337363837363234396335386663356434343861643561353764343330303566303934623163
          663165613931386466663632363763623866
    volumes:
     - /media/c/configs/scripts/discord-bot:/code
    command: "bash /code/start.sh"
