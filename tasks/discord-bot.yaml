- name: Update discord-bot code
  git:
    repo: https://gitlab.theflinners.com/joshfokis/discord-bot.git
    update: yes
    dest: /media/c/configs/scripts/discord-bot/

- name: Restart a container
  docker_container:
    name: discordbot
    image: python:3
    state: started
    pull: true
    restart: yes
    restart_policy: unless-stopped
    env:
        APITOKEN: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31306534353932643265336239373534633663393063313038316630303637336332323464303631
          6230326138303863636430356538306633323864376338630a653038393365613138396664373432
          32613033326237636566346364363565346262336633653162663362313839653130303438393237
          3534316538383435380a336137653261323164653563623837363266646239303139643637623631
          34626231626130366165393034333536346563643230346166373335643533396236
        DISCORDTOKEN: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          37343331373835613834393438633939373432613738333634626532356234363834613036626134
          6635626539316338376363366164646161393530383338370a393939653034626237366566396430
          32383430366634653936666130383734666566666665303830326635376631303639333563623333
          6630343364343032360a316262643434613336316438303236316539353036333737396163666139
          39613233303532393064383236613331366364623232646334343030393832646366376639346233
          32393161306233356163353039623938626164623631343865346262613164383136373231376465
          333035336364656539633436623464333434
    volumes:
     - /media/c/configs/scripts/discord-bot:/code
    command: "bash /code/start.sh"
